/* Original from https://github.com/jseidelin/exif-js. Modifications made for web worker compatibility */
var EXIF=function(){function r(b,a,e,d,f){var c=b.getUint16(a+2,!f);d=b.getUint32(a+4,!f);e=b.getUint32(a+8,!f)+e;var g,h;switch(c){case 1:case 7:if(1==d)return b.getUint8(a+8,!f);e=4<d?e:a+8;a=[];for(c=0;c<d;c++)a[c]=b.getUint8(e+c);return a;case 2:return m(b,4<d?e:a+8,d-1);case 3:if(1==d)return b.getUint16(a+8,!f);e=2<d?e:a+8;a=[];for(c=0;c<d;c++)a[c]=b.getUint16(e+2*c,!f);return a;case 4:if(1==d)return b.getUint32(a+8,!f);a=[];for(c=0;c<d;c++)a[c]=b.getUint32(e+4*c,!f);return a;case 5:if(1==d)return g=
b.getUint32(e,!f),h=b.getUint32(e+4,!f),b=new Number(g/h),b.numerator=g,b.denominator=h,b;a=[];for(c=0;c<d;c++)g=b.getUint32(e+8*c,!f),h=b.getUint32(e+4+8*c,!f),a[c]=new Number(g/h),a[c].numerator=g,a[c].denominator=h;return a;case 9:if(1==d)return b.getInt32(a+8,!f);a=[];for(c=0;c<d;c++)a[c]=b.getInt32(e+4*c,!f);return a;case 10:if(1==d)return b.getInt32(e,!f)/b.getInt32(e+4,!f);a=[];for(c=0;c<d;c++)a[c]=b.getInt32(e+8*c,!f)/b.getInt32(e+4+8*c,!f);return a}}function m(b,a,e){var d="";for(n=a;n<a+
e;n++)d+=String.fromCharCode(b.getUint8(n));return d}function p(b,a){if("Exif"!=m(b,a,4))return g&&console.log("Not valid EXIF data! "+m(b,a,4)),!1;var e,d=a+6;if(18761==b.getUint16(d))e=!1;else if(19789==b.getUint16(d))e=!0;else return g&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;if(42!=b.getUint16(d+2,!e))return g&&console.log("Not valid TIFF data! (no 0x002A)"),!1;if(8!=b.getUint32(d+4,!e))return g&&console.log("Not valid TIFF data! (First offset not 8)",b.getUint16(d+4,!e)),
!1;var f=d+8,c=s,p=b.getUint16(f,!e),h={},k,q,l;for(l=0;l<p;l++)k=f+12*l+2,q=c[b.getUint16(k,!e)],!q&&g&&console.log("Unknown tag: "+b.getUint16(k,!e)),h[q]=r(b,k,d,f,e);return h}var g=!1,s={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",
283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"};return{getData:function(b){if(b.exifdata)return b.exifdata;var a;a:{a=(new FileReaderSync).readAsArrayBuffer(b);var e=
new DataView(a);g&&console.log("Got file of length "+a.byteLength);if(255!=e.getUint8(0)||216!=e.getUint8(1))g&&console.log("Not a valid JPEG"),a=!1;else{for(var d=2,f=a.byteLength,c;d<f;){if(255!=e.getUint8(d)){g&&console.log("Not a valid marker at offset "+d+", found: "+a.getByteAt(d));a=!1;break a}c=e.getUint8(d+1);g&&console.log(c);if(225==c){g&&console.log("Found 0xFFE1 marker");a=p(e,d+4,e.getUint16(d+2)-2);break a}d+=2+e.getUint16(d+2)}a=void 0}}b.exifdata=a||{};return a}}}();
